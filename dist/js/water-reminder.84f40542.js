class WaterReminder extends ReminderManager{constructor(t,i){super("water",t,i),this.dailyWaterCount=0,this.dailyGoal=8,this.lastDrinkTime=null,this.drinkHistory=[],this.loadDailyData(),console.log("喝水提醒器已创建")}loadDailyData(){try{const t=(new Date).toDateString(),i=localStorage.getItem("waterReminder_dailyData");if(i){const a=JSON.parse(i);a.date===t?(this.dailyWaterCount=a.count||0,this.drinkHistory=a.history||[],this.lastDrinkTime=a.lastDrinkTime||null):this.resetDailyData()}}catch(t){console.warn("加载今日喝水数据失败:",t),this.resetDailyData()}}saveDailyData(){try{const t={date:(new Date).toDateString(),count:this.dailyWaterCount,history:this.drinkHistory,lastDrinkTime:this.lastDrinkTime};localStorage.setItem("waterReminder_dailyData",JSON.stringify(t))}catch(t){console.warn("保存今日喝水数据失败:",t)}}resetDailyData(){this.dailyWaterCount=0,this.drinkHistory=[],this.lastDrinkTime=null,this.saveDailyData()}confirmDrink(t=250){const i=Date.now();this.dailyWaterCount++,this.lastDrinkTime=i,this.drinkHistory.push({time:i,amount:t}),this.settings.lastReminder=i,this.saveDailyData(),this.reset(),this.showDrinkConfirmation(),this.triggerStatusChange({status:"drink-confirmed",isActive:!0,isPaused:!1,timeRemaining:this.timeRemaining,dailyCount:this.dailyWaterCount,dailyGoal:this.dailyGoal,lastDrinkTime:this.lastDrinkTime}),console.log(`已确认喝水，今日第${this.dailyWaterCount}杯`)}showDrinkConfirmation(){const t=Math.min(this.dailyWaterCount/this.dailyGoal,1),i=Math.round(100*t);let a=`很好！今日已喝水 ${this.dailyWaterCount} 杯`;this.dailyWaterCount>=this.dailyGoal?a+="\n🎉 恭喜！您已完成今日喝水目标！":a+=`\n还需 ${this.dailyGoal-this.dailyWaterCount} 杯即可完成今日目标 (${i}%)`,this.notificationService.showInPageAlert("success",{title:"💧 喝水确认",message:a,duration:3e3}),this.dailyWaterCount===this.dailyGoal&&setTimeout(()=>{this.notificationService.showInPageAlert("celebration",{title:"🎉 目标达成！",message:"恭喜您完成今日喝水目标！保持良好的习惯！",duration:5e3})},1e3)}triggerReminder(){if(!this.isActive)return;let t="长时间工作容易脱水，记得补充水分哦！";if(this.dailyWaterCount>0){const i=Math.max(0,this.dailyGoal-this.dailyWaterCount);i>0?t+=`\n今日已喝 ${this.dailyWaterCount} 杯，还需 ${i} 杯完成目标`:t="继续保持良好的喝水习惯！"}this.notificationService.showNotification("water","💧 喝水时间到了！",t,()=>this.confirmDrink(),()=>this.snooze(),{actions:[{action:"drink",title:"已喝水",icon:"💧"},{action:"snooze",title:"5分钟后提醒",icon:"⏰"}]}),this.triggerStatusChange({status:"triggered",isActive:!0,isPaused:!1,timeRemaining:0,dailyCount:this.dailyWaterCount,dailyGoal:this.dailyGoal}),setTimeout(()=>{this.isActive&&0===this.timeRemaining&&this.reset()},6e4),console.log("喝水提醒已触发")}getDailyStats(){const t=this.drinkHistory.reduce((t,i)=>t+i.amount,0),i=Math.min(this.dailyWaterCount/this.dailyGoal,1);return{count:this.dailyWaterCount,goal:this.dailyGoal,progress:i,progressPercent:Math.round(100*i),totalAmount:t,lastDrinkTime:this.lastDrinkTime,history:[...this.drinkHistory],isGoalReached:this.dailyWaterCount>=this.dailyGoal}}setDailyGoal(t){t>0&&t<=20?(this.dailyGoal=t,this.saveDailyData(),console.log(`每日喝水目标已设置为 ${t} 杯`)):console.warn("每日目标应在1-20杯之间")}getDrinkingSuggestion(){const t=(new Date).getHours(),i=this.dailyWaterCount/this.dailyGoal;return t<9?"早晨起床后喝一杯温水，有助于唤醒身体机能":t<12?i<.3?"上午工作时间，记得多补充水分保持精力充沛":"上午的喝水量不错，继续保持！":t<14?"午餐时间，适量饮水有助于消化":t<18?i<.6?"下午容易疲劳，多喝水有助于保持注意力":"下午的水分补充很及时！":t<20?i<.8?"晚餐前适量补水，但不要过量影响食欲":"今日喝水量很棒，晚上适量即可":"睡前1-2小时减少饮水，避免影响睡眠质量"}getCurrentStatus(){return{...super.getCurrentStatus(),dailyStats:this.getDailyStats(),suggestion:this.getDrinkingSuggestion()}}reset(){super.reset();const t=(new Date).toDateString(),i=localStorage.getItem("waterReminder_dailyData");if(i)try{JSON.parse(i).date!==t&&this.resetDailyData()}catch(t){console.warn("检查日期数据失败:",t)}}destroy(){this.saveDailyData(),super.destroy(),console.log("喝水提醒器已销毁")}}"undefined"!=typeof module&&module.exports&&(module.exports=WaterReminder);